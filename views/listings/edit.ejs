<% layout("/layouts/boilerplate") -%>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-vE6+H0sQ5aLw9hVg6t3WXo8w+jHfJtq4j4Pq2D8nHJj6e3R6r+f5iw9pH+a4Fj0p8QhceY/8L2Y2z2+I4Zp7Fg==" crossorigin="anonymous" referrerpolicy="no-referrer" />

<style>
body {
  background: #f5f5f7;
  font-family: "Poppins", sans-serif;
  margin: 0;
  padding: 0;
}

.row {
  display: flex;
  justify-content: center;
  padding: 15px 10px;
}

.cols {
  background: #fff;
  padding: 20px 15px;
  border-radius: 12px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.08);
  width: 100%;
  max-width: 600px;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.cols:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(0,0,0,0.12);
}

.cols h1 {
  text-align: center;
  font-size: 1.6rem;
  color: #222;
  margin-bottom: 15px;
  font-weight: 700;
}

.form-group {
  position: relative;
  margin-bottom: 12px;
}

.form-group i {
  position: absolute;
  top: 50%;
  left: 10px;
  transform: translateY(-50%);
  font-size: 1rem;
  transition: all 0.3s ease;
}

form input, form textarea {
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 8px 10px 8px 35px;
  width: 100%;
  font-size: 0.9rem;
  transition: all 0.2s ease;
}

form input:focus, form textarea:focus {
  border-color: #ff385c;
  box-shadow: 0 0 6px rgba(255,56,92,0.2);
  outline: none;
}

.invalid-feedback {
  color: #ff385c;
  font-size: 0.75rem;
  margin-top: 2px;
}

.add-btn {
  background: #ff385c;
  color: #fff;
  border: none;
  border-radius: 20px;
  padding: 9px 15px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  width: 100%;
  margin-top: 12px;
}

.add-btn:hover {
  background: #e12e50;
  transform: translateY(-1px);
}

.current-image {
  width: 100%;
  height: 200px;
  object-fit: cover;
  border-radius: 8px;
  margin-bottom: 12px;
}

/* ---------- Colorful Icons ---------- */
.icon-title { color: #4CAF50; }
.icon-desc { color: #2196F3; }
.icon-image { color: #FF9800; }
.icon-price { color: #9C27B0; }
.icon-location { color: #FF5722; }
.icon-country { color: #3F51B5; }

.form-group i:hover {
  transform: translateY(-2px) scale(1.2);
}

.row > .cols .row > .col-md-4, 
.row > .cols .row > .col-md-8, 
.row > .cols .mb-3.col-md-5 {
  padding-left: 4px;
  padding-right: 4px;
}

@media screen and (max-width:768px) {
  .cols {
    padding: 15px 10px;
  }
  .row > .cols .row > .col-md-4,
  .row > .cols .row > .col-md-8,
  .row > .cols .mb-3.col-md-5 {
    padding-left: 0;
    padding-right: 0;
  }
}
</style>

<body>
  <div class="row">
    <div class="cols col-12">
      <h1>Edit Listing</h1>
      <form method="post" action="/listings/<%=listing._id%>?_method=PUT" novalidate class="needs-validation" enctype="multipart/form-data">
        
        <div class="form-group">
          <i class="fa-solid fa-heading icon-title"></i>
          <input type="text" name="listing[title]" placeholder="Title" value="<%=listing.title%>" required>
          <div class="invalid-feedback">Please enter a valid title</div>
        </div>

        <div class="form-group">
          <i class="fa-solid fa-align-left icon-desc"></i>
          <textarea name="listing[description]" placeholder="Description" rows="2" required><%=listing.description%></textarea>
          <div class="invalid-feedback">Please enter a valid description</div>
        </div>

        <div class="form-group">
          <img src="<%= originalImageUrl %>" class="current-image" alt="Current listing image"/>
        </div>

        <div class="form-group">
          <i class="fa-solid fa-image icon-image"></i>
          <input type="file" name="listing[image]">
          <div class="invalid-feedback">Please upload a valid image</div>
        </div>

        <div class="row">
          <div class="form-group col-md-4">
            <i class="fa-solid fa-indian-rupee-sign icon-price"></i>
            <input type="number" name="listing[price]" placeholder="Price" value="<%=listing.price%>" required>
            <div class="invalid-feedback">Please enter a valid price</div>
          </div>
          <div class="form-group col-md-8">
            <i class="fa-solid fa-location-dot icon-location"></i>
            <input type="text" name="listing[location]" placeholder="Location" value="<%=listing.location%>" required>
            <div class="invalid-feedback">Please enter a valid location</div>
          </div>
        </div>

        <div class="form-group">
          <i class="fa-solid fa-globe icon-country"></i>
          <input type="text" name="listing[country]" placeholder="Country" value="<%=listing.country%>" required>
          <div class="invalid-feedback">Please enter a valid country</div>
        </div>

        <button class="add-btn">Update Listing</button>
      </form>
    </div>
  </div>
</body>
